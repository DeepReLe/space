% -----------------------
% ///--- Preamble --- \\\
% -----------------------

\documentclass[a4paper,11pt]{article}

% --- Packages ---
% Language
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[english]{babel}
% Font
\usepackage{lmodern}
% Math
\usepackage{amsmath,amssymb,amsfonts,mathrsfs}
\usepackage[amsmath,thmmarks]{ntheorem}
% Code
%\usepackage{listings}
%\usepackage{color}
%\lstset{language=Octave,
%        showspaces=false,
%        showstringspaces=false,
%        frame=single,
%        basicstyle=\scriptsize,
%        numbers=left,
%        numberstyle=\footnotesize,
%        numbersep=5pt}
% Graphics (Postscript)
%\usepackage{graphicx, pst-all}
\usepackage{graphicx}
% Style
\usepackage{fancyhdr}
\usepackage{lastpage}

%Commands
\renewcommand{\labelenumi}{(\alph{enumi})}
\renewcommand{\labelenumii}{(\arabic{enumii})}

% --- Definitions ---
% Counter
\newcounter{behctr}
% Theorem-Styles
\newtheorem{claim}[behctr]{Claim}
\newtheorem{rmk}{Remark}
%% Proof environment with a small square as a "qed" symbol
\theoremstyle{nonumberplain}
\newtheorem{defn}{Definition}
\newtheorem{thm}{Theorem}
%\theoremheaderfont{\normalfont\slshape}
\theorembodyfont{\normalfont}
\theoremsymbol{\ensuremath{\square}}
\newtheorem{proof}{Proof}
\setlength\theorempostskipamount{0pt}
\setlength\theorempreskipamount{5pt}
% Math-commands
\newcommand{\inv}{^{-1}}  % inverse
\newcommand{\vnorm}[1]{\left|\left|#1\right|\right|}  % norm of a vector
\newcommand{\set}[2]{\{\nonscript\,{#1}\mid{#2}\nonscript\,\}}  % sets with proper spacing
\DeclareMathOperator{\rank}{rk}
\DeclareMathOperator{\id}{id}
\DeclareMathOperator{\Inv}{Inv}
\DeclareMathOperator{\Aut}{Aut}
\DeclareMathOperator{\Ker}{Ker}
\DeclareMathOperator{\Image}{Im}
\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\grad}{grad}
\DeclareMathOperator\nN{\mathbb{N}}
\DeclareMathOperator\nZ{\mathbb{Z}}
\DeclareMathOperator\nQ{\mathbb{Q}}
\DeclareMathOperator\nR{\mathbb{R}}
\DeclareMathOperator\nC{\mathbb{C}}
\DeclareMathOperator\nH{\mathbb{H}}
\DeclareMathOperator\nD{\mathbb{D}}
\renewcommand{\vec}[1]{\mathbf{#1}}  % vectors
% Hat for Vectors
%\let\oldhat\hat
%\renewcommand{\hat}[1]{\oldhat{\mathbf{#1}}}
% Postscripsettings
%\psset{arrows=->,
%       unit=1.65cm,
%       arcangle=15,
%       linewidth=0.65pt,
%       arrowsize=4pt,
%       arrowinset=.25,
%       labelsep=2.5pt,
%       nodesep=2pt,
%       subgriddiv=10,
%       shortput=nab}

% --- Layout ---
\pagestyle{fancy}
% Text
\addtolength{\textwidth}{2cm}
\addtolength{\oddsidemargin}{-1cm}
\addtolength{\evensidemargin}{-1cm}
\addtolength{\textheight}{1.5cm}
\addtolength{\headheight}{2pt}
\addtolength{\topmargin}{-0.5cm}
\addtolength{\headsep}{-0.25cm}
% Header
\renewcommand{\headrulewidth}{0.4pt}
\fancyheadoffset{0.5cm}
%\lhead{D-MATH}
%\chead{Computational Geometry HS12}
%\rhead{May Szedl\'ak}
% Footer
\renewcommand{\footrulewidth}{0.4pt}
\fancyfootoffset{-4cm}
\lfoot{}
\cfoot{\thepage\ / \pageref{LastPage}}
\rfoot{}
\parindent0pt

% -----------------------
% ///--- Document --- \\\
% -----------------------
\begin{document}

\section{Hit-and-Run}
The Hit-and-Run algorithm used for sampling in a convex body $K$, was introduced by Smith in 1984 \cite{Smith}. The mixing time is known to be $\mathcal{O}^*(n^2R^2/r^2)$, where $R$ and $r$ are the radii of the inscribed and cicumscribed ball of $K$ respectively \cite{Dyer, Lovasz}.
In the case of the muscles of a limb, we are interested in the polygon $P$ that is given by the set of all possible activations $\textbf{a} \in \mathbb{R}^n$ that satisfy
\[\textbf{f} = A\textbf{a}, \textbf{a} \in [0,1]^n,\]
where $\textbf{f} \in \mathbb{R}^m$ is a fixed force vector and $A = J^{-T}RF_m \in \mathbb{R}^{m \times n}$. $P$ is bounded by the unit $n$-cube since all variables $a_i$, $i \in [n]$ are bounded by 0 and 1 from below, above respectively.

Consider the following $1 \times 3$ example.
\begin{align*}
&1 = \frac{10}{3}a_1 - \frac{53}{15}a_2 + 2a_3 \\
&a_1, a_2, a_3 \in [0,1],
\end{align*}
the set of feasible activations is given by the shaded set in figure ??.

\textit{\textbf{FIGURE 1}}

The Hit-and-Run walk on $P$ is defined as follows (it works analogously for any convex body). 
\begin{enumerate}
\item Find a given starting point $\textbf{p}$ of $P$ .
\item Generate a random direction through $\textbf{p}$ (uniformly at random over all directions).
\item Choose the next point of the sampling algorithm uniformly at random from the segment of the line in $P$. 
\item Repeat from $(b)$ the above steps with the new point as the starting point.
\end{enumerate}

\textit{
\textbf{FIGURE 2}: Figures in 2D or 3D? Better in 3D to have the overview.
\begin{enumerate}
\item figure inner point
\item figure choice of direction
\item figure line segment
\item figure choice of new point
\item figure of distribution after some sampling
\end{enumerate}}

The implementation of this algorithm is straight forward except for the choice of the random direction. How do we sample uniformly at random (u.a.r.) from all directions in $P$? Suppose that $\textbf{q}$ is a direction in $P$ and $p \in P$. Then by definition of $P$, $\textbf{q}$ must satisfy $\textbf{f} = A(\textbf{p}+\textbf{q})$. Since $\textbf{p} \in P$, we know that $\textbf{f} = A\textbf{p}$ and therefore 
\[\textbf{f} = A(\textbf{p} + \textbf{q}) = \textbf{f} + A\textbf{q}\]
and hence
\[A\textbf{q} = 0.\]

\textit{\textbf{FIGURE 3}: $q$ must be parallel to the plane given by $1 = \frac{10}{3}a_1 - \frac{53}{15}a_2 + 2a_3$.}

We therefore need to choose directions uniformly at random from all directions in the vectorspace 
\[V = \{\textbf{q} \in \mathbb{R}^n | A\textbf{q} = 0\}.\]

As shown by Marsaglia this can be done as follows \cite{Marsaglia}.

\begin{enumerate}
\item
Find an orthonormal basis $b_1, \dots, b_r \in \mathbb{R}^{n}$ of $A\textbf{q} =0$.
\item
Choose $(\lambda_1, \dots, \lambda_r) \in \mathcal{N}(0,1)^n$ (from the Gaussian distribution).
\item
$\sum_{i=1}^r \lambda_i b_i$ is a u.a.r.\ direction.
\end{enumerate}

A basis of a vectorspace $V$ is a minimal set of vectors that generate $V$, and it is orthonormal if the vectors are pairwise orthogonal (perpendicular) and have unit length. Using basic linear algebra one can find a basis for $V = \{A\textbf{q} = 0\}$ and orthogonalize it with the well known Gram-Schmidt method (for details see e.g.\ \cite{Robertson}). Note that in order to get the desired u.a.r.\ distribution the basis needs to be orthonormal. For the limb case we can safely assume that the rows of $A$ are linearly independent and hence the number of basis vectors is $n-m$.

\textit{\textbf{FIGURE 4}
\begin{enumerate}
\item Some basis
\item orthonormal basis
\end{enumerate}}



\bibliographystyle{plain}
\bibliography{redundancyFVC}

\end{document}